Εισαγωγή στην Python | mathesis.cup.gr
===================
 
Τελική εργασία : mynews
------------- 

Δημιουργία μιας προσωποποιημένης υπηρεσίας ανάκτησης ειδήσεων από την ειδησεογραφική ιστοσελίδα in.gr

**1. Εισαγωγή**

H έγκυρη ειδησεογραφική ιστοσελίδα in.gr διαθέτει υπηρεσία απευθείας αναφοράς ειδήσεων για διάφορες θεματικές κατηγορίες ειδήσεων με μορφή rss (http://rss.in.gr).

Στην εργασία αυτή ζητείται να κατασκευαστεί μια εφαρμογή που ενημερώνει τον χρήστη για ειδήσεις με βάση τα καταχωρημένα ενδιαφέροντά του.

Δίνεται ένας ημιτελής κώδικας main.py καθώς και άλλα βοηθητικά αρχεία.

Θα πρέπει να απαντηθούν 8 ερωτήματα που περιέχονται ήδη στο αρχείο, τροποποιώντας κατάλληλα τον κώδικα στο αρχείο main.py. Δεν θα πρέπει να πειραχτεί ο υπόλοιπος κώδικας του αρχείου, ή το βοηθητικό αρχείο util.py

**2. Περιγραφή βοηθητικών αρχείων**

Στην ενότητα αυτή γίνεται σύντομη περιγραφή βοηθητικών αρχείων : util.py, users.csv και news.csv

**util.py**

Το αρχείο αυτό είναι ένα βοηθητικό πρόγραμμα python που ενσωματώνεται στο κυρίως πρόγραμμά μέσω της εντολής import utilities. Περιλαμβάνει δύο συναρτήσεις, την csv_to_dict(fname) και την dict_to_csv(d, fname) - περιλαμβάνει ακόμη μια βοηθητική συνάρτηση για έλεγχο καλής λειτουργίας τους.

Οι συναρτήσεις αυτές επιτρέπουν, η πρώτη να αποθηκεύσουμε μια λίστα από λεξικά ως ένα αρχείο csv, και η δεύτερη να ανακτήσουμε τα δεδομένα ενός αρχείου csv σε μια λίστα από λεξικά.

Ένα παράδειγμα λειτουργίας των συναρτήσεων αυτών.

Έστω το αρχείο user_profiles.csv (που περιέχει τα προφίλ χρηστών), ότι έχει το εξής περιεχόμενο:

| user | area | keywords |
|--|--|--|
| maria	| Ειδήσεις | Ερντογάν |
| kostas | Αθλητισμός: Βόλεϊ | ΠΑΟΚ |
| kostas | Παιδί | ύπνο |
| kostas | Ειδήσεις Ελλάδα | απεργία |
| kostas | Ειδήσεις Κόσμος | |
| abdul	| Ειδήσεις Ελλάδα | |
| nikos	| Ειδήσεις Πολιτισμός |	Καζαντζάκη$όπερα |
| nikos | Υγεία | γονίδια |

Όταν κληθεί η συνάρτηση csv_to_dict('user_profiles.csv') αυτή θα  επιστρέψει την εξής λίστα από λεξικά:

    [ {'user': 'maria', 'area': 'Ειδήσεις', 'keywords': 'Ερντογάν'} 
      {'user': 'kostas', 'area': 'Αθλητισμός: Βόλεϊ', 'keywords': 'ΠΑΟΚ'} 
      {'user': 'kostas', 'area': 'Παιδί', 'keywords': 'ύπνο'} 
      {'user': 'kostas', 'area': 'Ειδήσεις Ελλάδα', 'keywords': 'απεργία'}
      {'user': 'kostas', 'area': 'Ειδήσεις Κόσμος', 'keywords': ''}
      {'user': 'abdul', 'area': 'Ειδήσεις Ελλάδα', 'keywords': ''}
      {'user': 'nikos', 'area': 'Ειδήσεις Πολιτισμός', 'keywords': 'Καζαντζάκη$όπερα'} 
      {'user': 'nikos', 'area': 'Υγεία', 'keywords': 'γονίδια'} ]
    
Το αντίστροφο γίνεται από τη συνάρτηση dict_to_csv(d, fname), αυτή διαβάζει μια λίστα από λεξικά d και το μεταφέρει σε ένα αρχείο fname τύπου csv.

Οι βοηθητικές αυτές συναρτήσεις χρησιμοποιούνται από το κυρίως πρόγραμμα αφού αποθηκεύουν σε αρχεία χαρακτήρων τις δομές δεδομένων που χρησιμοποιούνται.

**users.csv**

To αρχείο αυτό περιέχει τα προφίλ των χρηστών. Μεταβάλλεται κατά τη λειτουργία του προγράμματος. Κάθε γραμμή του αρχείου αφορά μια θεματική περιοχή ειδήσεων που ενδιαφέρει τον χρήστη, άρα ο ίδιος χρήστης μπορεί να εμφανίζεται σε πολλές γραμμές, αν ενδιαφέρεται για πολλές θεματικές περιοχές ειδήσεων. Για κάθε θεματική περιοχή μπορεί να υπάρχουν όροι αναζήτησης (στήλη keywords). Αν σε κάποια θεματική περιοχή έχουν οριστεί πολλοί όροι, αυτοί χωρίζονται με τον χαρακτήρα $.

Παράδειγμα:

| user | area | keywords |
|--|--|--|
| maria | Ειδήσεις | Ερντογάν |
| nikos	| Ειδήσεις Πολιτισμός |	Καζαντζάκη$όπερα |
| nikos | Υγεία | γονίδια |

Στον παραπάνω πίνακα, ο χρήστης nikos ενδιαφέρεται για τη θεματική περιοχή «Ειδήσεις Πολιτισμός» με όρους αναζήτησης τη λέξη «Καζαντζάκη» ή τη λέξη «όπερα», ενώ ο χρήστης maria ενδιαφέρεται για τη θεματική περιοχή «Ειδήσεις» με όρους αναζήτησης «Ερντογάν».

**news.csv**

Το αρχείο αυτό δεν μεταβάλλεται κατά τη χρήση του προγράμματος. Περιλαμβάνει τις διευθύνσεις των 24 rss feeds των διαφόρων θεματικών περιοχών ειδήσεων που χρησιμοποιούνται ως πηγές ειδήσεων. Το περιεχόμενο του αρχείου αυτού είναι το εξής:

| title	| rss |
|--|--|
| Ειδήσεις Ελλάδα | http://rss.in.gr/feed/news/greece |
| Ειδήσεις | http://rss.in.gr/feed/news | 
| Ειδήσεις Κόσμος | http://rss.in.gr/feed/news/world | 
| Ειδήσεις Οικονομία | http://rss.in.gr/feed/news/economy | 
| Ειδήσεις Επιστήμη | http://rss.in.gr/feed/news/science |
| Ειδήσεις Πολιτισμός | http://rss.in.gr/feed/news/culture |
| Αθλητισμός: Ποδόσφαιρο | http://rss.in.gr/feed/sports/football |
| Αθλητισμός: Μπάσκετ | http://rss.in.gr/feed/sports/basketball |
| Αθλητισμός: Βόλεϊ | http://rss.in.gr/feed/sports/volleyball |
| Αθλητισμός: Υγρός Στίβος | http://rss.in.gr/feed/sports/watersports |
| Αθλητισμός: Στίβος | http://rss.in.gr/feed/sports/track |
| Αθλητισμός: Άλλα Αθλήματα | http://rss.in.gr/feed/sports/othersports |
| Αθλητισμός | http://rss.in.gr/feed/sports | 
| Αυτοκίνητο | http://rss.in.gr/feed/auto | 
| Αγροτουρισμός | http://rss.in.gr/feed/agro | 
| Τεχνολογία | http://rss.in.gr/feed/technology/main | 
| Υγεία | http://rss.in.gr/feed/health | 
| Υγεία: Ειδήσεις | http://rss.in.gr/feed/health/news | 
| Υγεία: Διατροφή | http://rss.in.gr/feed/health/diatrofi | 
| Υγεία: Αντρας | http://rss.in.gr/feed/health/man | 
| Υγεία: Γυναίκα | http://rss.in.gr/feed/health/woman | 
| Υγεία: Παιδί | http://rss.in.gr/feed/health/child | 
| Υγεία: Ηλικιωμένοι | http://rss.in.gr/feed/health/elderly | 
| Παιδί | http://rss.in.gr/feed/kid/main |

----------

**ΕΡΩΤΗΜΑ 1 - login_user()**

H συνάρτηση αυτή ζητάει από τον χρήστη το username και επιστρέφει True/False. Αν ο χρήστης δεν δώσει όνομα επιστρέφει την τιμή False. Αν δώσει όνομα, ελέγχει αν αυτός υπάρχει ήδη καλώντας τη συνάρτηση retrieve_user(username). Αν η retrieve_user() επιστρέψει True (βρέθηκε χρήστης) τότε τυπώνει ένα μήνυμα καλωσορίσματος και επιστρέφει την τιμή True. Αν η retrieve_user() επιστρέψει False (δεν βρέθηκε χρήστης) τότε ρωτάει τον χρήστη αν θέλει να δημιουργήσει προφίλ. Aν απαντήσει θετικά, το όνομα αποθηκεύεται στην καθολική μεταβλητή user με κενή λίστα, καλείται η συνάρτηση update_user() η οποία αποθηκεύει το προφίλ του χρήστη στο αρχείο users_file, και επιστρέφει True. Αν απαντήσει αρνητικά επιστρέφει False.

**ΕΡΩΤΗΜΑ 2 - admin()** 

Είναι η συνάρτηση που δημιουργεί και διαγράφει χρήστες (λειτουργίες διαχειριστή) και καλείται από την login_user() αν ο χρήστης δώσει το όνομα admin. Η συνάρτηση αυτή φορτώνει το αρχείο χρηστών και επαναληπτικά ρωτάει τον διαχειριστή αν θέλει να διαγράψει ή να προσθέσει χρήστες. Αν ο διαχειριστής διαγράψει έναν χρήστη, αυτός αφαιρείται από το αρχείο χρηστών. Αν ο διαχειριστής προσθέσει ένα χρήστη, αυτός προστίθεται με κενό προφίλ στο αρχείο χρηστών. Η συνάρτηση χρησιμοποιεί τις βοηθητικές συναρτήσεις του αρχείου util.py Δεν επιστρέφει τιμή.

**ΕΡΩΤΗΜΑ 3 - retrieve_user(username)**

Η συνάρτηση αυτή ανακτά τα στοιχεία του χρήστη με βάση το όνομα username που έδωσε ο χρήστης. Επιστρέφει True/False αν ο χρήστης βρέθηκε ή όχι, αντίστοιχα. Συγκεκριμένα, επιστρέφει True αν ο χρήστης βρέθηκε στο αρχείο users_file, ενώ επιστρέφει False αν δεν βρέθηκε ο χρήστης στο αρχείο users_file. Στην περίπτωση αυτή φορτώνεται το λεξικό που περιέχει τα στοιχεία του χρήστη στην καθολική μεταβλητή user, για παράδειγμα: user = {'user': 'nikos', 'areas': {'Ειδήσεις Πολιτισμός': ['Καζαντζάκη'], 'Υγεία': []}. Όταν μια θεματική περιοχή ειδήσεων περιέχει πολλούς όρους αναζήτησης, αυτοί θα αποθηκευτούν ως μια συμβολοσειρά με το $ ως διαχωριστικό. Συνεπώς πρέπει να διαχωριστούν και να  εισαχθούν στη σχετική λίστα όρων αναζήτησης.

**ΕΡΩΤΗΜΑ 4 - update_user()**

H συνάρτηση αυτή αποθηκεύει το περιεχόμενο της καθολικής μεταβλητής user στο αρχείο users_file. Αν στο αρχείο users_file υπάρχουν ήδη άλλοι χρήστες, ανακτώνται αυτοί πρώτα, προστίθεται στη συνέχεια ο χρήστης user και αποθηκεύονται τέλος όλοι οι χρήστες ξανά στο users_file. Επίσης οι όροι αναζήτησης που υπάρχουν για κάποιο θέμα θα αποθηκευτούν ως μια συμβολοσειρά με το χαρακτήρα $ ως διαχωριστικό. Η συνάρτηση επιστρέφει None.

**ΕΡΩΤΗΜΑ 5 - print_news_item(item_no)**

Η συνάρτηση τυπώνει την είδηση με αριθμό item_no που βρίσκεται αποθηκευμένη στο αρχείο mytemp.csv. Χρησιμοποιείται η βοηθητική συνάρτηση formatted_print() για το σώμα της είδησης. Η συνάρτηση επιστρέφει True αν η είδηση βρέθηκε και τυπώθηκε και False αν όχι.

**ΕΡΩΤΗΜΑ 6 - manage_profile(feeds)** 

Ζητείται από τον χρήστη να ορίσει τα θέματα ειδήσεων που τον ενδιαφέρουν. Ένας ενδεικτικός διάλογος ορισμού θεμάτων ειδήσεων είναι ο εξής:

> Τα ενδιαφέροντά σας είναι ...ΚΑΝΕΝΑ ΕΝΔΙΑΦΕΡΟΝ
> 
> Μπορείτε να προσθέστε θέμα με +αριθμό ή να αφαιρέσετε με -αριθμό (enter για να συνεχίσετε)+0 +16 +7
> 
> Τα ενδιαφέροντά σας είναι ...Ειδήσεις Ελλάδα, Αθλητισμός: Μπάσκετ, Υγεία, 
> 
> Τα κύρια θέματα ειδήσεων είναι: .... 
> 0:Ειδήσεις Ελλάδα
> 1:Ειδήσεις
> 2:Ειδήσεις Κόσμος
> 3:Ειδήσεις Οικονομία
> 4:Ειδήσεις Επιστήμη
> 5:Ειδήσεις Πολιτισμός
> 6:Αθλητισμός: Ποδόσφαιρο
> 7:Αθλητισμός: Μπάσκετ
> 8:Αθλητισμός: Βόλεϊ
> 9:Αθλητισμός: Υγρός Στίβος
> 10:Αθλητισμός: Στίβος
> 11:Αθλητισμός: Άλλα Αθλήματα
> 12:Αθλητισμός
> 13:Αυτοκίνητο
> 14:Αγροτουρισμός
> 15:Τεχνολογία
> 16:Υγεία
> 17:Υγεία: Ειδήσεις
> 18:Υγεία: Διατροφή
> 19:Υγεία: Αντρας
> 20:Υγεία: Γυναίκα
> 21:Υγεία: Παιδί
> 22:Υγεία: Ηλικιωμένοι
> 23:Παιδί
> 
> Τα ενδιαφέροντά σας είναι ...Ειδήσεις Ελλάδα, Αθλητισμός: Μπάσκετ, Υγεία, 
> 
> Μπορείτε να προσθέστε θέμα με +αριθμό ή να αφαιρέσετε με -αριθμό (enter για να συνεχίσετε)

**ΕΡΩΤΗΜΑ 7 - manage_profile(feeds)** 

Ζητείται από τον χρήστη για κάθε θέμα ειδήσεων που τον ενδιαφέρει να προσθέσει ή να αφαιρέσει όρους αναζήτησης. Ένας ενδεικτικός διάλογος προσθήκης όρων αναζήτησης ακολουθεί:

>Τα θέματα ειδήσεων που σας ενδιαφέρουν είναι:
>Ειδήσεις Ελλάδα
>Υγεία
>Αθλητισμός: Μπάσκετ
>
>Τώρα για κάθε θέμα ειδήσεων μπορείτε να επιλέξετε όρους αναζήτησης
>
>ΘΕΜΑ:  Ειδήσεις Ελλάδα  .. Όροι αναζήτησης: []
>
>Μπορείτε να προσθέσετε ή να αφαιρέσετε όρους για κάθε θέμα με +λέξη, -λέξη....(enter για να συνεχίσετε)+Τσίπρας
>
>ΘΕΜΑ:  Ειδήσεις Ελλάδα  .. Όροι αναζήτησης: ['Τσίπρας']
>
>Μπορείτε να προσθέσετε ή να αφαιρέσετε όρους για κάθε θέμα με +λέξη, -λέξη....(enter για να συνεχίσετε)
>
>ΘΕΜΑ:  Υγεία  .. Όροι αναζήτησης: []
>
>Μπορείτε να προσθέσετε ή να αφαιρέσετε όρους για κάθε θέμα με +λέξη, -λέξη....(enter για να συνεχίσετε)+ύπνος
>
>ΘΕΜΑ:  Υγεία  .. Όροι αναζήτησης: ['ύπνος']
>
>Μπορείτε να προσθέσετε ή να αφαιρέσετε όρους για κάθε θέμα με +λέξη, -λέξη....(enter για να συνεχίσετε)
>
>ΘΕΜΑ:  Αθλητισμός: Μπάσκετ  .. Όροι αναζήτησης: []
>
>Μπορείτε να προσθέσετε ή να αφαιρέσετε όρους για κάθε θέμα με +λέξη, -λέξη....(enter για να συνεχίσετε)+ΠΑΟΚ +ΑΕΚ
>
>ΘΕΜΑ:  Αθλητισμός: Μπάσκετ  .. Όροι αναζήτησης: ['ΠΑΟΚ', 'ΑΕΚ']
>
>Μπορείτε να προσθέσετε ή να αφαιρέσετε όρους για κάθε θέμα με +λέξη, -λέξη....(enter για να συνεχίσετε)

**ΕΡΩΤΗΜΑ 8 - clear_temps()**

Στη συνάρτηση αυτή που καλείται κατά την ολοκλήρωση του προγράμματος, ζητείται να καθαριστούν όποια προσωρινά βοηθητικά αρχεία έχουν δημιουργηθεί κατά τη διάρκεια εκτέλεσης του προγράμματος - να διαγραφούν πριν την έξοδο από το πρόγραμμα.


----------
